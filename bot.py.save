from aiogram import Bot, Dispatcher, F
from aiogram.types import Message, ReplyKeyboardMarkup, KeyboardButton
from aiogram.filters import CommandStart
import asyncio

# === –ù–ê–°–¢–†–û–ô–ö–ò ===
TOKEN = "8404546108:AAHM0CcJzk-7Mvrmk0K2tnnAD_-lUT19aI4"
ADMIN_CHAT_ID = -1002629914250   # ID –≤–∞—à–µ–π –≥—Ä—É–ø–ø—ã
TOPIC_WORK = 3                   # –¢–µ–º–∞ "–í —Ä–∞–±–æ—Ç–µ"
TOPIC_QUESTIONS = 2              # –¢–µ–º–∞ "–í–æ–ø—Ä–æ—Å—ã"

# –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç—ã –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
bot = Bot(token=TOKEN)
dp = Dispatcher()

# –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
main_kb = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª")],
        [KeyboardButton(text="‚ùì –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å")]
    ],
    resize_keyboard=True
)

# === –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ===

# /start
@dp.message(CommandStart())
async def start_cmd(message: Message):
    await message.answer(
        "–ü—Ä–∏–≤–µ—Ç! üëã –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
        reply_markup=main_kb
    )

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
@dp.message(F.text == "üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª")
async def send_material(message: Message):
    await message.answer("–ü—Ä–∏–∫—Ä–µ–ø–∏ —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ + –¥–∞–π –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ")

# –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å
@dp.message(F.text == "‚ùì –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å")
async def ask_question(message: Message):
    await message.answer("–ó–∞–¥–∞–π –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –∫–∞—Å–∞–µ–º–æ —É—Ä–æ–∫–∞ —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä—ã –∏ —Å–ø–æ—Ä—Ç–∞ –≤ —à–∫–æ–ª–µ, –∞ —è —Ç–µ–±–µ –æ—Ç–≤–µ—á—É –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è")

# –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤/—Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
@dp.message()
async def forward_to_group(message: Message):
    if message.reply_to_message:
        return  # —á—Ç–æ–±—ã –±–æ—Ç –Ω–µ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–ª—Å—è

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —á—Ç–æ –±—ã–ª–æ –≤—ã–±—Ä–∞–Ω–æ
    if message.text and "–º–∞—Ç–µ—Ä–∏–∞–ª" in message.text.lower():
        # —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∫–Ω–æ–ø–∫–∞ ‚Äî –Ω–µ –ø–µ—Ä–µ—Å—ã–ª–∞–µ–º
        return
    if message.text andx "–≤–æ–ø—Ä–æ—Å" in message.text.lower():
        return

    # –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª–æ –ø–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª"
    if message.text or message.photo or message.video or message.document:
        # –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —à–ª—ë–º –≤ "–í —Ä–∞–±–æ—Ç–µ"
        await message.send_copy(chat_id=ADM
